<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-06-22 Tue 14:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Go Recipes - Gosh Tips</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Nick Wells" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/readtheorg.css"/>
<script type="text/javascript" src="src/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="src/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Go Recipes - Gosh Tips</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd25dee9">Gosh Tips</a>
<ul>
<li><a href="#org87912f5">Installing gosh</a>
<ul>
<li><a href="#org0591a62">Summary</a></li>
<li><a href="#orgd794720">Discussion</a></li>
</ul>
</li>
<li><a href="#org0b47d73">Running code</a>
<ul>
<li><a href="#org771ab4b">Summary</a></li>
<li><a href="#org8fb3e43">Discussion</a></li>
</ul>
</li>
<li><a href="#org9f57ef6">Code sections</a>
<ul>
<li><a href="#orgdb75ef2">Summary</a></li>
</ul>
</li>
<li><a href="#org449ea67">Shortcuts for printing</a>
<ul>
<li><a href="#org301a785">Summary</a></li>
</ul>
</li>
<li><a href="#orgf02c5ad">Snippets</a>
<ul>
<li><a href="#org2a7b505">Summary</a></li>
</ul>
</li>
<li><a href="#orgbd8094d">Looping over input</a>
<ul>
<li><a href="#org66fd2b6">Summary</a></li>
</ul>
</li>
<li><a href="#orgc930080">Help</a>
<ul>
<li><a href="#orgecd87c7">Summary</a></li>
</ul>
</li>
<li><a href="#orgcdb70b7">Missing goimports command</a>
<ul>
<li><a href="#org3a752b6">Summary</a></li>
<li><a href="#org1edcfca">Discussion</a></li>
</ul>
</li>
<li><a href="#org7fec2d6">goimports isn't finding my package</a>
<ul>
<li><a href="#orga5f702a">Summary</a></li>
</ul>
</li>
<li><a href="#org8a85d5f">Applying a gosh parameter every time it runs</a>
<ul>
<li><a href="#orga63b819">Summary</a></li>
<li><a href="#org6fba7c9">Discussion</a></li>
</ul>
</li>
<li><a href="#org419cad4">Command line parameter completion</a>
<ul>
<li><a href="#org8ff6a31">Summary</a></li>
</ul>
</li>
<li><a href="#org8d13823">Troubleshooting the generated program</a>
<ul>
<li><a href="#org2fe13bc">Summary</a></li>
</ul>
</li>
<li><a href="#org3ff87e8">What is gosh doing</a>
<ul>
<li><a href="#orgb646193">Summary</a></li>
</ul>
</li>
<li><a href="#orgd000051">Useful shell aliases</a>
<ul>
<li><a href="#org26db466">Summary</a></li>
</ul>
</li>
<li><a href="#orgfaac0b8">Using gosh in shebang scripts</a>
<ul>
<li><a href="#orgba9c28e">Summary</a></li>
<li><a href="#orgeab742f">Discussion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgd25dee9" class="outline-2">
<h2 id="orgd25dee9">Gosh Tips</h2>
<div class="outline-text-2" id="text-orgd25dee9">
<p>
These recipes offer some tips for getting the most from gosh and how to fix
any problems you might have.
</p>

<p>
For other recipes <a href="gorecipes.html">see here</a>.
</p>
</div>
<div id="outline-container-org87912f5" class="outline-3">
<h3 id="org87912f5">Installing gosh</h3>
<div class="outline-text-3" id="text-org87912f5">
</div>
<div id="outline-container-org0591a62" class="outline-4">
<h4 id="org0591a62">Summary</h4>
<div class="outline-text-4" id="text-org0591a62">
<p>
To install gosh run the following command:
</p>

<div class="org-src-container">
<pre class="src src-sh">go install github.com/nickwells/utilities/gosh@latest
</pre>
</div>

<p>
This will install the gosh command in the $GOPATH/bin directory (by
default: $HOME/go/bin). Make sure you have that directory added to your
PATH.
</p>
</div>
</div>

<div id="outline-container-orgd794720" class="outline-4">
<h4 id="orgd794720">Discussion</h4>
<div class="outline-text-4" id="text-orgd794720">
<p>
The gosh command is self contained but there are some extras which
you can also install.
</p>

<p>
To install the snippets you will need to choose where you want to copy
them. Gosh comes with some standard directories which it will search for
snippets, the following command will list them:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -snippet-list-dir
</pre>
</div>

<p>
Choose one of these directories and set the SD shell variable to the
directory name (this is just for the purpose of the installation commands
below).
</p>

<p>
The recommended way of installing the snippets is to install the
gosh.snippet command and then use that to install the standard
snippets. The following command will create the snippet directory if it
doesn't already exist and will copy in the standard set of snippets,
moving aside any differing snippets of the same name.
</p>

<div class="org-src-container">
<pre class="src src-sh">go install github.com/nickwells/utilities/gosh.snippet@latest
gosh.snippet -to $SD -install
</pre>
</div>

<p>
If you run it without the install parameter it will just compare the
standard snippet set with the contents of the directory you have
given. If you are installing the snippets for the first time then it
should report them as all being new.
</p>

<p>
Alternatively you can copy the snippets directly. If you git clone the
utilities repository you can find the _snippets directory under the
gosh.snippet directory. The following commands (on Linux) will create
the snippets directory and copy in the standard snippets, when run from
the gosh.snippet source directory.
</p>

<div class="org-src-container">
<pre class="src src-sh">mkdir --parents $SD
cp -r --suffix=.orig --backup ./_snippets/* $SD
</pre>
</div>

<p>
Once you have installed the snippets, using either of the methods above,
you should clear out any copies generated of snippets you may have set up
before. You only need to do this if you already had older versions of the
snippets in target directory. A useful command for helping with this is
the findCmpRm command which can be installed as follows.
</p>

<div class="org-src-container">
<pre class="src src-sh">go install github.com/nickwells/utilities/findCmpRm@latest
findCmpRm -dir $SD -recursive -extension .orig
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0b47d73" class="outline-3">
<h3 id="org0b47d73">Running code</h3>
<div class="outline-text-3" id="text-org0b47d73">
</div>
<div id="outline-container-org771ab4b" class="outline-4">
<h4 id="org771ab4b">Summary</h4>
<div class="outline-text-4" id="text-org771ab4b">
<p>
The 'exec' parameter (or its synonym 'e') gives code for gosh to run.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -e 'fmt.Println("Hi!")'
</pre>
</div>

<p>
This will print "Hi!".
</p>
</div>
</div>

<div id="outline-container-org8fb3e43" class="outline-4">
<h4 id="org8fb3e43">Discussion</h4>
<div class="outline-text-4" id="text-org8fb3e43">
<p>
You can have multiple lines of code by repeating the exec parameter; they
are added in the order they appear on the command line. Alternatively you
can have multiple lines in the same parameter; make sure that you've
quoted it correctly so the shell doesn't think you've finished the
command early. You can separate Go statements with semi-colons either;
these are not normally needed by Go and the gofmt (or goimports) command
will replace them with new lines but it can make it easier when entering
Go code at the command line. The following are all equivalent:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -e 'fmt.Print("Greetings,")' -e 'fmt.Println(" Universe!")'
gosh -e 'fmt.Print("Greetings,"); fmt.Println(" Universe!")'
gosh -e 'fmt.Print("Greetings,")
fmt.Println(" Universe!")'
</pre>
</div>

<p>
Code given to gosh through the 'exec' parameter will appear in the 'main'
function. If you want to declare a function you will need to add it to
the global scope using the 'global' (or 'g') parameter. The following
code declares a function that prints "Hello, World!" and then calls it.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -g 'func F() { fmt.Print("Hello, World!\n") }' -e 'F()'
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9f57ef6" class="outline-3">
<h3 id="org9f57ef6">Code sections</h3>
<div class="outline-text-3" id="text-org9f57ef6">
</div>
<div id="outline-container-orgdb75ef2" class="outline-4">
<h4 id="orgdb75ef2">Summary</h4>
<div class="outline-text-4" id="text-orgdb75ef2">
<p>
When gosh builds the code to be run it builds it in sections. There are
the boilerplate sections that gosh generates itself and there are
sections that gosh populates with code that you have given. The code
sections are listed in a help note; run the following code to see this
note.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -help-note 'Gosh - code sections'
</pre>
</div>

<p>
The sections are each separate and you can populate them
independently. Code added to a section is added in the order it appears
on the command line. For instance:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -after 'fmt.Print("a1")' \
     -exec 'fmt.Print("e1")' \
     -before 'fmt.Print("b1")' \
     -after 'fmt.Print("a2")' \
     -exec 'fmt.Print("e2")' \
     -before 'fmt.Print("b2")'
</pre>
</div>

<p>
will print "b1b2e1e2a1a2" so you can see that the sections are grouped
independently. Code in the 'global' section is for global variables and
functions, it will appear outside the main function.
</p>

<p>
The different sections are present because gosh can run code in a loop
where it reads from standard input (or files) a line at a time and then
the code in the 'before' section appears before the loop, the 'after'
section comes after the loop and the 'exec' section runs inside the loop.
</p>
</div>
</div>
</div>

<div id="outline-container-org449ea67" class="outline-3">
<h3 id="org449ea67">Shortcuts for printing</h3>
<div class="outline-text-3" id="text-org449ea67">
</div>
<div id="outline-container-org301a785" class="outline-4">
<h4 id="org301a785">Summary</h4>
<div class="outline-text-4" id="text-org301a785">
<p>
There are some shortcuts that gosh offers to make it faster and easier to
write scripts. Printing is a common task and gosh offers some parameters
to make this simpler. The following are equivalent:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -pln '"Hi!"'
gosh -e 'fmt.Println("Hi!")'
</pre>
</div>
<p>
&#x2026; and &#x2026;
</p>
<div class="org-src-container">
<pre class="src src-sh">gosh -pf '"pi = %.9f\n", math.Pi'
gosh -e 'fmt.Printf("pi = %.9f\n", math.Pi)'
</pre>
</div>

<p>
There are similar shortcuts for printing in the various code sections;
see the help message for details.
</p>
</div>
</div>
</div>

<div id="outline-container-orgf02c5ad" class="outline-3">
<h3 id="orgf02c5ad">Snippets</h3>
<div class="outline-text-3" id="text-orgf02c5ad">
</div>
<div id="outline-container-org2a7b505" class="outline-4">
<h4 id="org2a7b505">Summary</h4>
<div class="outline-text-4" id="text-org2a7b505">
<p>
gosh allows you to have useful code fragments called snippets in files
and to import them into the program being built. These can either be
given as complete filenames or, more usefully, as shorter names in
standard directories. To see all the snippets available pass the
snippet-list parameter as follows:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -snippet-list
</pre>
</div>

<p>
You can write your own snippets, just create a file containing Go code
into one of the snippet directories and you can start using it. It's
worth adding some documentary comments as well though if only so you'll
remember what it was for. The standard snippets are all documented and
use the meaningful comment tags to help gosh check that snippets are
being used correctly.
</p>

<p>
When writing a snippet it is worth following the convention of starting
the names of any variables you create with a double underscore. This will
mean you are unlikely to clash with the names of any variables that
you'll use in your gosh scripts and it also avoids clashing with
variables that gosh itself creates (these all start with a single
underscore).
</p>

<p>
To see the gosh notes on snippets the following gosh command will show
you just what you need.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -help-notes 'Gosh - snippets,Gosh - snippet comments,Gosh - snippet directories'
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbd8094d" class="outline-3">
<h3 id="orgbd8094d">Looping over input</h3>
<div class="outline-text-3" id="text-orgbd8094d">
</div>
<div id="outline-container-org66fd2b6" class="outline-4">
<h4 id="org66fd2b6">Summary</h4>
<div class="outline-text-4" id="text-org66fd2b6">
<p>
A common task at the command line is to read the standard output of a
previous command, do something with it and write the transformed input
onto the standard output. In Unix terminology such programs are called
filters. Gosh offers some parameters to help write filters in Go at the
command line.
</p>

<p>
The 'run-in-readloop' parameter (or 'n' for short) will use a
bufio.Scanner called 'under{}l' to read from standard input (by default) and
the lines (with any newline removed) are then available to you using the
'Text' method on the scanner.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -n -b 'count := 0' -e 'count++' -a-pln count
</pre>
</div>

<p>
This will count the lines like the Linux 'wc' command.    
</p>

<p>
If you want to split the line into parts run gosh passing the
'split-line' (or 's') parameter. The default behaviour splits the line
into words separated by one or more whitespace characters. You can change
the regular expression used to split the line by passing the
'split-pattern' (or 'sp') parameter. The parts are written into a slice
of strings called '_lp'.
</p>

<p>
If you want to run the script over a list of files instead of over the
standard input these files can be provided after the '&#x2013;' parameter. In
this case the script will loop over each file in turn. In this case the
before-inner and after-inner code sections become useful as you can use
them to insert code af=round the inner loop.
</p>
</div>
</div>
</div>

<div id="outline-container-orgc930080" class="outline-3">
<h3 id="orgc930080">Help</h3>
<div class="outline-text-3" id="text-orgc930080">
</div>
<div id="outline-container-orgecd87c7" class="outline-4">
<h4 id="orgecd87c7">Summary</h4>
<div class="outline-text-4" id="text-orgecd87c7">
<p>
Gosh comes with a comprehensive manual built in. For the standard help
message:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -help
</pre>
</div>

<p>
For the complete help message:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -help-full
</pre>
</div>

<p>
You can get help on individual parameters; this will just give the
help for the exec parameter:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -help-param exec
</pre>
</div>

<p>
You can get help on groups of parameters; this will just give the
help for the snippet listing parameters:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -help-group cmd-snippet-list
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcdb70b7" class="outline-3">
<h3 id="orgcdb70b7">Missing goimports command</h3>
<div class="outline-text-3" id="text-orgcdb70b7">
</div>
<div id="outline-container-org3a752b6" class="outline-4">
<h4 id="org3a752b6">Summary</h4>
<div class="outline-text-4" id="text-org3a752b6">
<p>
If you have goimports properly installed on your machine then gosh will
run it to format the program before running it. This will add any import
statements you need.
</p>

<p>
There can be a number of problems:
</p>
<ul class="org-ul">
<li>goimports is not installed</li>
<li>it is installed but it isn't in any directory in the PATH</li>
<li>it's deliberately not installed</li>
</ul>

<p>
If it isn't installed then you can install it by following the
instructions at <a href="https://pkg.go.dev/golang.org/x/tools/cmd/goimports">golang.org/x/tools/cmd/goimports</a>.
</p>

<p>
If it is not in your PATH then you can tell gosh the
formatter to use as follows:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -e 'fmt.Print("Hello,")
     fmt.Println(" World!")' -formatter /home/me/go/bin/goimports
</pre>
</div>

<p>
If it's not installed and you don't want to install it
then you will need to give all the imports explicitly.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -e 'var v rune; fmt.Println(unsafe.Sizeof(v))' -import unsafe -import fmt
</pre>
</div>
</div>
</div>

<div id="outline-container-org1edcfca" class="outline-4">
<h4 id="org1edcfca">Discussion</h4>
<div class="outline-text-4" id="text-org1edcfca">
<p>
The goimports program is a very useful tool - it will format your program
just like gofmt but it will also find any packages that haven't been
imported and it will add import statements for them. It can sometimes
pick the wrong version of a module and so you might want to provide the
package import explicitly even if it is available.
</p>
</div>
</div>
</div>

<div id="outline-container-org7fec2d6" class="outline-3">
<h3 id="org7fec2d6">goimports isn't finding my package</h3>
<div class="outline-text-3" id="text-org7fec2d6">
</div>
<div id="outline-container-orga5f702a" class="outline-4">
<h4 id="orga5f702a">Summary</h4>
<div class="outline-text-4" id="text-orga5f702a">
<p>
You have goimports installed and you've called some function from the
package but goimports isn't finding it; what's the problem?
</p>

<p>
The first thing to check is that you've got the function name correct and
the right arguments, that's a common reason for failing to import the
right package.
</p>

<p>
Another reason, if the package has just been uploaded, is that the Go
proxy might not have been updated yet. You can either wait a few minutes
or else import the package by hand through the -import (or -I) parameter.
</p>
</div>
</div>
</div>

<div id="outline-container-org8a85d5f" class="outline-3">
<h3 id="org8a85d5f">Applying a gosh parameter every time it runs</h3>
<div class="outline-text-3" id="text-org8a85d5f">
</div>
<div id="outline-container-orga63b819" class="outline-4">
<h4 id="orga63b819">Summary</h4>
<div class="outline-text-4" id="text-orga63b819">
<p>
if you want to run gosh with a set of common parameters every time you
can put these parameters in one of the configuration files. Run gosh
as follows to see the configuration files.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -help-show sources
</pre>
</div>

<p>
Note that parameter names in configuration files don't start with a
leading dash.
</p>
</div>
</div>

<div id="outline-container-org6fba7c9" class="outline-4">
<h4 id="org6fba7c9">Discussion</h4>
<div class="outline-text-4" id="text-org6fba7c9">
<p>
You add parameters to the configuration file, one per line, with the
parameter name (no leading dash) at the start of the line followed by an
equals ("=") and then the parameter value. If the parameter does not take
a value you can just give the parameter name. Blank lines are ignored and
white space around the parts of the line are ignored. You can comment the
file: any text from a "#" to the end of line is ignored. You can also
keep configuration parameters in other files and import them with an
@include directive. This might be more useful for commands with a lot
more configuration parameters especially ones shared between multiple
programs.
</p>

<p>
The sort of parameters that you might want to have in your configuration
files are:
</p>
<ul class="org-ul">
<li>the names of some commands that gosh uses such as the formatter or the
editor. In both these cases the default behaviour is usually what you
want but the option is there if needed.</li>
<li>the name of some additional snippet directory. You might want to have
your personal snippets in a separate directory so that there is no
chance of them being overwritten when you install a new set of standard
snippets.</li>
</ul>

<p>
At first it might seem that the configuration file pathnames are
unnecessarily long but they are chosen to ensure uniqueness when each
program may potentially have its own configuration file and other
competing naming systems might be in use. The directories holding the
files are named for the Go module name and the base directories are named
according to the XDG spec.
</p>

<p>
All the Go programs under github.com/nickwells use the same standard for
configuration file naming, they are of the form:
</p>

<p>
XDG-config-directory / Go-module / program-or-package / common.cfg
</p>
</div>
</div>
</div>

<div id="outline-container-org419cad4" class="outline-3">
<h3 id="org419cad4">Command line parameter completion</h3>
<div class="outline-text-3" id="text-org419cad4">
<p>
Most modern shells offer command-specific parameter completion at the
command prompt, gosh can help set this up.
</p>
</div>
<div id="outline-container-org8ff6a31" class="outline-4">
<h4 id="org8ff6a31">Summary</h4>
<div class="outline-text-4" id="text-org8ff6a31">
<p>
If you are using zsh you can get gosh to generate the parameter expansion
file to support this. To find out more details call gosh as follows:
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -help-group common.params-completion
</pre>
</div>

<p>
You will only need to do this once though you might want to repeat it
when you upgrade gosh to a more recent version with more parameters.
</p>

<p>
Note that there is a single configuration file shared between all
programs using the github.com/nickwells/param.mov/v5/param package (this
includes gosh and gosh.snippet). You can set the completions directory
once in that file and then you won't need to set it for each program when
you are building the completion rules.
</p>
</div>
</div>
</div>

<div id="outline-container-org8d13823" class="outline-3">
<h3 id="org8d13823">Troubleshooting the generated program</h3>
<div class="outline-text-3" id="text-org8d13823">
</div>
<div id="outline-container-org2fe13bc" class="outline-4">
<h4 id="org2fe13bc">Summary</h4>
<div class="outline-text-4" id="text-org2fe13bc">
<p>
If the code you supply doesn't behave as you think it should you can
always examine the generated program. If there is an error while running
the program or it can't be run at all then it will usually show the name
of the directory where gosh built your program. This will not have been
cleared up as usual and so you can take a look at the generated
code. Alternatively you can run gosh with the show-filename parameter.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -pln '"Hello World!"' -show-filename
</pre>
</div>

<p>
This will run the program as normal but will report the directory and
file names and will not clear the directory when it finishes so you can
examine the code.
</p>

<p>
Alternatively, you can run gosh with the edit parameter and it will open
the gosh-generated program in your favourite editor just before running
it and you can correct any problems or just take a look at what gets
generated.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -pln '"Hello World!"' -edit
</pre>
</div>

<p>
You can also make gosh loop around the edit/build/run steps until you are
happy with the result. To achieve this call gosh with the edit-repeat
parameter.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -pln '"Hello World!"' -edit-repeat
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3ff87e8" class="outline-3">
<h3 id="org3ff87e8">What is gosh doing</h3>
<div class="outline-text-3" id="text-org3ff87e8">
</div>
<div id="outline-container-orgb646193" class="outline-4">
<h4 id="orgb646193">Summary</h4>
<div class="outline-text-4" id="text-orgb646193">
<p>
If you run gosh as usual but add a "-verbose" parameter it will run the
program but it will also print out messages explaining the steps it is
taking and some timing information.
</p>

<div class="org-src-container">
<pre class="src src-sh">gosh -pln '"Hello, World!"' -verbose
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd000051" class="outline-3">
<h3 id="orgd000051">Useful shell aliases</h3>
<div class="outline-text-3" id="text-orgd000051">
</div>
<div id="outline-container-org26db466" class="outline-4">
<h4 id="org26db466">Summary</h4>
<div class="outline-text-4" id="text-org26db466">
<p>
Your shell may offer an alias feature so that you can access commands
more quickly, here are a few suggestions for some aliases that speed up
common gosh tasks. These work in zsh and bash at least. You might need to
change the alias names if they clash with any existing aliases. Note that
the aliases use the long parameter names for documentation purposes; the
following comments give an equivalent short-form.
</p>

<div class="org-src-container">
<pre class="src src-sh">alias g.e="gosh -exec"		# -e
alias g.es="gosh -exec-snippet"	# -e-s
alias g.p="gosh -println"		# -pln
alias g.pf="gosh -printf"		# -pf
alias g.h="gosh -help"		# -help
alias g.has="gosh -help-all-short"	# -help-as
alias g.hf="gosh -help-full"		# -help-f
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfaac0b8" class="outline-3">
<h3 id="orgfaac0b8">Using gosh in shebang scripts</h3>
<div class="outline-text-3" id="text-orgfaac0b8">
<p>
gosh can be used as the interpreter for shebang scripts, that is
executable text files with the first line starting '#!'.
</p>
</div>
<div id="outline-container-orgba9c28e" class="outline-4">
<h4 id="orgba9c28e">Summary</h4>
<div class="outline-text-4" id="text-orgba9c28e">
<p>
You can write Go code in a file and put:
</p>

<div class="org-src-container">
<pre class="src src-sh">#!gosh -shebang
</pre>
</div>

<p>
at the very top of the file and gosh will read the rest of the file as a
script to be built into a main func and run it.
</p>
</div>
</div>

<div id="outline-container-orgeab742f" class="outline-4">
<h4 id="orgeab742f">Discussion</h4>
<div class="outline-text-4" id="text-orgeab742f">
<p>
The shebang parameter (you can use exec-file or e-f instead) can be
preceded by any number of other parameters such as import parameters to
populate the list of import statements.
</p>

<p>
You can set the dont-format parameter before the shebang parameter to
save the cost of formatting and also to ensure it runs even if goimports
is not present. In this case you must be sure to have given all the
necessary imports manually.
</p>

<p>
Similarly you can set the Go command version to use explicitly.
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Nick Wells</p>
<p class="date">Created: 2021-06-22 Tue 14:22</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
